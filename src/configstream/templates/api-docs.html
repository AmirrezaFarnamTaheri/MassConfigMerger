{% extends "base.html" %}

{% block title %}API Documentation - ConfigStream{% endblock %}

{% block header_title %}API Documentation{% endblock %}

{% block content %}
<div class="container mx-auto p-4">
    <div class="card">
        <h1 class="text-3xl font-bold mb-6">API Documentation</h1>
        <p class="text-xl text-gray-300 mb-8">Programmatic access to your ConfigStream data.</p>

        <div class="space-y-8">
            <div class="prose prose-invert max-w-none">
                <h2 id="api-current">GET /api/current</h2>
                <p>Fetch the current, most recently tested proxy nodes. This endpoint provides the same data that powers the main dashboard.</p>
                <h3>Query Parameters:</h3>
                <ul>
                    <li><code>protocol</code> (string): Filter by protocol (e.g., "VMess", "VLESS", "Trojan").</li>
                    <li><code>country</code> (string): Filter by country code (e.g., "US", "DE", "JP").</li>
                    <li><code>max_ping</code> (integer): Filter by maximum latency in milliseconds.</li>
                    <li><code>search</code> (string): Search for a term in the city, organization, or IP address fields.</li>
                </ul>

                <h2 id="api-history">GET /api/history</h2>
                <p>Fetch historical test data. This can be useful for tracking the performance of your proxy nodes over time.</p>
                <h3>Query Parameters:</h3>
                <ul>
                    <li><code>hours</code> (integer, default: 24): How many hours of history to retrieve.</li>
                </ul>

                <h2 id="api-statistics">GET /api/statistics</h2>
                <p>Get aggregated statistics about the current nodes, including total nodes, successful nodes, protocol distribution, and country distribution.</p>

                <h2 id="api-export">GET /api/export/&lt;format&gt;</h2>
                <p>Export the current nodes in a specified format. This is useful for importing your configurations into other applications.</p>
                <h3>URL Parameters:</h3>
                <ul>
                    <li><code>format</code> (string): "json" or "csv".</li>
                </ul>

                <h2 id="api-status">GET /api/status</h2>
                <p>Get real-time system status information, including uptime, CPU usage, and memory usage.</p>

                <h2 id="api-logs">GET /api/logs</h2>
                <p>Fetch the latest application logs. Requires an API key if one is configured in your <code>config.yaml</code>.</p>

                <h2 id="api-scheduler-jobs">GET /api/scheduler/jobs</h2>
                <p>Get the status of all scheduled jobs. Requires an API key if one is configured.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block head_extra %}
<style>
    .prose {
        color: var(--text-light-200);
    }
    .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
        color: var(--text-light-100);
        border-bottom: 1px solid var(--bg-dark-700);
        padding-bottom: 0.5rem;
    }
    .prose a {
        color: var(--accent-blue-500);
    }
    .prose a:hover {
        color: var(--accent-blue-600);
    }
    .prose strong {
        color: var(--text-light-100);
    }
    .prose code {
        color: var(--text-light-100);
        background-color: var(--bg-dark-700);
        padding: 0.2em 0.4em;
        margin: 0;
        font-size: 85%;
        border-radius: 3px;
    }
</style>
{% endblock %}